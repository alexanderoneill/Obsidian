# S3 Overview
- Amazon S3 is one of t he main building blocks of AWS
- It's advertised as "infinitely scaling" storage
- Many websites use Amazon S3 as a backbone
- Many AWS services use Amazon S3 as an integration as well
## Amazon S3 Use Cases
- Backup and storage
- Disaster recovery
- Archive
- Hybrid Cloud storage
- Application hosting
- Media hosting
- Data lakes and big data analytics
- Software delivery 
- Static websites
- E.g. Nasdaq stores 7 years of data in S3 Glacier
- E.g. Sysco runs analytics on its data and gain business insights
## Amazon S3 Buckets
- Amazon S3 allows people to store objects (files) in "buckets" (directories)
- Buckets must have a globally unique name across all regions and all accounts
- Buckets are defined at the region level
- S3 looks like a global service but buckets are created in a region
- Naming convention:
	- No uppercase, no underscore
	- 3-63 characters long
	- Not an IP
	- Must start with lowercase letter or number
	- Must not start with the prefix xn--
	- Must not end with the suffix -s3alias
## Amazon S3 Objects
- Objects (files) have a Key
- The key is the FULL path
	- s3://my-bucket/my_file.txt
	- s3://my-bucket/my_folder1/another_folder/my_file.txt
- The key is composed of **prefix** + *object name*
	- s3://my-bucket/**my_folder1/another_folder/** *my_file.txt*
	- There's no concept of "directories" within buckets (although the UI will trick you to think otherwise)
	- Just keys with very long names that contain slashes
- Object values are the content of the body
	- Max object size is 5TiB
	- If uploading more than 5GiB, must use "multi-part upload"
- Metadata (list of text key / value pairs - system or user metadata)
- Tags (Unicode key / value pair - up to 10) - useful for security / lifecycle
- Version ID (if versioning is enabled)
# S3 Security Bucket Policy
## Amazon S3 - Security
- User Based
	- IAM Policies - which API calls should be allowed for a specific user from IAM
- Resource Based
	- Bucket Policies - bucket wide rules from the S3 console - allows cross account
	- Object Access Control List (ACL) - finer grain (can be disabled)
	- Bucket Access Control List (ACL) - less common (can be disabled)
- Note: an IAM principal can access an S3 object if
	- The user IAM permissions ALLOW it or the resource policy ALLOWS it
	- And there's no explicit DENY
- Encryption: encrypt objects in Amazon S3 using encryption keys
# S3 Bucket Policies
- JSON based policies
	- Resources: buckets and objects
	- Effect: Allow / Deny
	- Actions: Set of API to Allow or Deny
	- Principal: The account or user to apply the policy to
- Use S3 bucket for policy to
	- Grant public access to the bucket
	- Force objects to be encrypted at upload
	- Grant access to another account (Cross Account)
![[8.1 S3 Bucket Policy JSON Example.png]]
# S3 Website Overview
- S3 can host static websites and have them accessible on the Internet
- The website URL will be http://bucket-name.s3-website-aws-region.amazonaws.com
- A bucket policy that does not allow public reads may lead to 403 Forbidden errors.
# S3 Versioning
- You can version your files in Amazon S3
- It is enabled at the bucket level
- Same key overwrite will change the "version": 1, 2 ,3 ...
- It is best practice to version your buckets
	- Protect against unintended deletes